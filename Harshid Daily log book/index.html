<!DOCTYPE html>
<html lang="en" class="h-100">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harshid Engravers - Log Book</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="style.css">    
</head>
<body class="h-100">

    <!-- Login Overlay -->
    <div id="loginOverlay" class="d-flex align-items-center justify-content-center p-4">
        <div class="card shadow-lg border-0" style="width: 100%; max-width: 440px;">
            <div class="card-body p-4 p-md-5">
                <h2 class="text-center text-primary fw-bold mb-4">Harshid Engravers</h2>
                
                <!-- Nav Tabs for Login/Register -->
                <ul class="nav nav-tabs nav-fill mb-4" id="loginTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="sign-in-tab" data-bs-toggle="tab" data-bs-target="#signInView" type="button" role="tab" aria-controls="signInView" aria-selected="true">Sign In</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#registerView" type="button" role="tab" aria-controls="registerView" aria-selected="false">Create Account</button>
                    </li>
                </ul>

                <!-- Tab Content -->
                <div class="tab-content" id="loginTabContent">
                    
                    <!-- Sign In View -->
                    <div class="tab-pane fade show active" id="signInView" role="tabpanel" aria-labelledby="sign-in-tab">
                        <p class="text-center text-muted mb-3">Please sign in to continue</p>
                        <form id="loginForm">
                            <div class="mb-3">
                                <label for="userId" class="form-label">User ID</label>
                                <input type="text" class="form-control form-control-lg" id="userId" placeholder="e.g., user@logbook" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <input type="password" class="form-control form-control-lg" id="password" placeholder="••••••••" required>
                            </div>
                            <p id="loginError" class="text-danger text-center small d-none mb-3"></p>
                            <div class="d-grid">
                                <button type="submit" id="loginSubmitBtn" class="btn btn-primary btn-lg fw-bold">
                                    Sign In
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Register View -->
                    <div class="tab-pane fade" id="registerView" role="tabpanel" aria-labelledby="register-tab">
                        <p class="text-center text-muted mb-3">Create a new user account</p>
                        <form id="registerForm">
                            <div class="mb-3">
                                <label for="newRegisterUserId" class="form-label">User ID</label>
                                <input type="text" class="form-control" id="newRegisterUserId" placeholder="e.g., new.user@logbook" required>
                            </div>
                            <div class="mb-3">
                                <label for="newRegisterPassword" class="form-label">Password</label>
                                <input type="password" class="form-control" id="newRegisterPassword" placeholder="••••••••" required>
                            </div>
                            <div class="mb-3">
                                <label for="confirmPassword" class="form-label">Confirm Password</label>
                                <input type="password" class="form-control" id="confirmPassword" placeholder="••••••••" required>
                            </div>
                            <p id="registerError" class="text-danger text-center small d-none mb-3"></p>
                            <p id="registerSuccess" class="text-success text-center small d-none mb-3"></p>
                            <div class="d-grid">
                                <button type="submit" id="registerSubmitBtn" class="btn btn-primary btn-lg fw-bold">
                                    Create Account
                                </button>
                            </div>
                        </form>
                    </div>

                </div>
            </div>
        </div>
    </div>


    <!-- Main Application Container (Hidden by default) -->
    <div id="mainAppContainer" class="d-none">

        <!-- Status Message Bar -->
        <div id="statusMessageContainer" class="position-sticky top-0" style="z-index: 1050;">
            <!-- Alert will be injected here -->
        </div>
    
        <!-- Header / Navbar -->
        <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm flex-shrink-0">
            <div class="container-fluid">
                <!-- Logo -->
                <a class="navbar-brand d-flex align-items-center" href="#">
                    <i class="bi bi-book-half text-primary" style="font-size: 1.5rem;"></i>
                    <span class="fs-5 fw-bold text-primary ms-2">Harshid Engravers</span>
                </a>

                <!-- Mobile Toggler -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Navbar Links -->
                <div class="collapse navbar-collapse" id="mainNavbar">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-lg-center">
                        <li class="nav-item">
                            <button data-page="logEntriesPage" class="nav-link d-flex align-items-center gap-2">
                                <i class="bi bi-card-list d-lg-none"></i>
                                <span>Log Entries</span>
                            </button>
                        </li>
                        <li class="nav-item">
                            <button data-page="addEntryPage" class="nav-link d-flex align-items-center gap-2">
                                <i class="bi bi-plus-square d-lg-none"></i>
                                <span>Add New Entry</span>
                            </button>
                        </li>
                        <li class="nav-item role-admin-only" style="display: none;">
                            <button data-page="manageUsersPage" class="nav-link d-flex align-items-center gap-2">
                                <i class="bi bi-people d-lg-none"></i>
                                <span>Manage Users</span>
                            </button>
                        </li>
                        <li class="nav-item d-lg-none"><hr class="dropdown-divider"></li>
                        <li class="nav-item">
                            <button data-action="signOut" class="nav-link text-danger d-flex align-items-center gap-2">
                                <i class="bi bi-box-arrow-right d-lg-none"></i>
                                <span>Sign Out</span>
                            </button>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="p-3 p-md-4">
            <div class="container-fluid">

                <!-- Page: Log Entries -->
                <div id="logEntriesPage" class="page-content">
                    
                    <!-- Search and Sort Controls -->
                    <div class="card shadow-sm border-0 mb-4">
                        <div class="card-body p-3">
                            <div class="row g-3">
                                <!-- Search Bar -->
                                <div class="col-lg-8">
                                    <label for="search" class="visually-hidden">Search</label>
                                    <div class="input-group">
                                        <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
                                        <input type="search" id="search" class="form-control" placeholder="Search by Name, Job Type, Payment, Date, or Description...">
                                    </div>
                                </div>
                                <!-- Sort Dropdown -->
                                <div class="col-lg-4">
                                    <label for="sort" class="visually-hidden">Sort by</label>
                                    <select id="sort" class="form-select">
                                        <option value="date-desc">Sort by Date (Newest First)</option>
                                        <option value="name-asc">Sort by Name (A-Z)</option>
                                        <option value="name-desc">Sort by Name (Z-A)</option>
                                        <option value="amount-desc">Sort by Amount (High-Low)</option>
                                        <option value="amount-asc">Sort by Amount (Low-High)</option>
                                        <option value="date-asc">Sort by Date (Oldest First)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Log Entries Grid -->
                    <div id="logEntriesContainer" class="row g-3 row-cols-1 row-cols-md-2 row-cols-xl-3">
                        <!-- Log entries will be injected here -->
                    </div>
                    
                    <!-- No Entries Message -->
                    <div id="noEntriesMessage" class="d-none text-center text-muted py-5">
                        <i class="bi bi-inbox display-1 text-secondary"></i>
                        <h3 class="mt-4 fs-4 fw-medium">No log entries found</h3>
                        <p class="mt-1 text-sm">Get started by adding a new entry.</p>
                    </div>

                    <!-- Total Amount (Admin Only) -->
                    <div id="totalAmountDisplay" class="role-admin-only card shadow-sm border-0 mt-4" style="display: none;">
                        <div class="card-body p-4 d-flex justify-content-between align-items-center">
                            <h3 class="fs-5 fw-bold text-dark mb-0">Total Amount</h3>
                            <span id="totalAmount" class="fs-3 fw-bold text-primary">₹0.00</span>
                        </div>
                    </div>

                </div>

                <!-- Page: Add New Entry -->
                <div id="addEntryPage" class="page-content d-none">
                    <div class="card shadow-sm border-0 p-3 p-md-4 mx-auto" style="max-width: 800px;">
                        <div class="card-body">
                            <h2 id="formTitle" class="fs-4 fw-bold text-primary mb-4">Add New Entry</h2>
                            <form id="logForm">
                                <input type="hidden" id="entryId">
                                
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="partyName" class="form-label">Party Name</label>
                                        <input type="text" id="partyName" class="form-control" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="jobType" class="form-label">Job Type</label>
                                        <input type="text" id="jobType" class="form-control" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="date" class="form-label">Date</label>
                                        <input type="date" id="date" class="form-control" required>
                                    </div>
                                    <div class="col-md-6 role-admin-only" style="display: none;">
                                        <label for="payment" class="form-label">Payment (INR)</label>
                                        <input type="number" id="payment" class="form-control" placeholder="0.00" step="0.01">
                                    </div>
                                    <div class="col-12">
                                        <label for="paymentMode" class="form-label">Payment Mode</label>
                                        <select id="paymentMode" class="form-select">
                                            <option>Cash</option>
                                            <option>Online (UPI, etc.)</option>
                                            <option>Bank Transfer</option>
                                            <option>Cheque</option>
                                            <option>Pending</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <label for="jobDescription" class="form-label">Job Description</label>
                                        <textarea id="jobDescription" class="form-control" rows="3" placeholder="Add notes about the job..."></textarea>
                                    </div>
                                </div>
                                
                                <!-- Form Buttons -->
                                <div class="d-flex align-items-center justify-content-end gap-2 mt-4">
                                    <button type="button" id="cancelEditBtn" class="btn btn-secondary d-none">
                                        Cancel
                                    </button>
                                    <button type="submit" id="submitBtn" class="btn btn-primary fw-bold px-4">
                                        Add Entry
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Page: Manage Users (Admin Only) -->
                <div id="manageUsersPage" class="page-content d-none role-admin-only" style="display: none;">
                    <div class="row g-4">
                        <!-- Add New User Form -->
                        <div class="col-lg-4">
                            <div class="card shadow-sm border-0 h-100">
                                <div class="card-body p-4">
                                    <h2 class="fs-4 fw-bold text-primary mb-4">Add New User</h2>
                                    <form id="addUserForm">
                                        <div class="mb-3">
                                            <label for="newUserId" class="form-label">New User ID</label>
                                            <input type="text" id="newUserId" class="form-control" placeholder="e.g., new@logbook" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newUserPassword" class="form-label">Password</label>
                                            <input type="password" id="newUserPassword" class="form-control" placeholder="••••••••" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newUserRole" class="form-label">Role</label>
                                            <select id="newUserRole" class="form-select">
                                                <option value="user">User</option>
                                                <option value="admin">Admin</option>
                                            </select>
                                        </div>
                                        <p id="addUserError" class="text-danger small text-center d-none mb-3"></p>
                                        <div class="d-grid">
                                            <button type="submit" id="addUserSubmitBtn" class="btn btn-primary fw-bold">
                                                Add User
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Existing Users List -->
                        <div class="col-lg-8">
                            <div class="card shadow-sm border-0">
                                <h2 class="fs-4 fw-bold text-primary p-4 border-bottom mb-0">Existing Users</h2>
                                <div id="usersListContainer" class="list-group list-group-flush">
                                    <!-- User list will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </main>

    </div> <!-- End Main App Container -->


    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <!-- App Logic -->
    <script type="module" src="script.js"></script>
</body>
</html>